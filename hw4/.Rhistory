setwd("~/GitHub/STAT579/hw4")
setwd("~/GitHub/STAT579/hw4")
setwd("~/GitHub/STAT579/hw4")
library(devtools) # error? then run install.packages("devtools")
devtools::install_github("heike/classdata")
library(classdata)
head(mojo)
str(mojo)
#2
summary(mojo$Week)
summary(mojo$WeekNo)
ggplot(data = mojo,aes(y=Week))+geom_boxplot()
library(ggplot2)
ggplot(data = mojo,aes(y=Week))+geom_boxplot()
ggplot(data = mojo,aes(x=Week))+geom_boxplot()
ggplot(data = mojo,aes(x=Week,y=WeekNo))+geom_boxplot()
ggplot(data = mojo)+geom_boxplot()
ggplot(data = mojo+geom_boxplot(aes=(x=Week))
ggplot(data = mojo)+geom_boxplot(aes=(x=Week))
ggplot(data = mojo)+geom_boxplot(aes=(x=Week))
x=Week,y=WeekNo=
ggplot(data = mojo,aes(x=Week,y=WeekNo=))+geom_boxplot()
ggplot(data = mojo,aes(x=Week,y=WeekNo=))+geom_boxplot()
ggplot(data = mojo,aes(x=Week,y=WeekNo))+geom_boxplot()
boxplot(mojo$Week)
boxplot(mojo$WeekNo)
boxplot(mojo$Week)
boxplot(mojo$Week,main="Car Milage Data",xlab="Number of Cylinders", ylab="Miles Per Gallon")
boxplot(mojo$Week,main="Boxplot of Week", ylab="Week")
boxplot(mojo$WeekNo,main="Boxplot of WeekNo", ylab="WeekNo")
#3
ggplot(data = mojo,aes(x=Total Gross,y=WeekNo))+geom_boxplot()
head(mojo)
#3
ggplot(data = mojo,aes(x='Total Gross',y=WeekNo))+geom_boxplot()
#3
ggplot(data = mojo,aes(x='Total Gross',y=WeekNo))+geom_boxplot()+ facet_wrap( ~ Year, ncol=2)
#3
ggplot(data = mojo,aes(x='Total Gross',y=WeekNo))+geom_bar()+ facet_wrap( ~ Year, ncol=2)
#3
ggplot(data = mojo,aes(x='Total Gross',y=WeekNo))+geom_point()+ facet_wrap( ~ Year, ncol=2)
#3
ggplot(data = mojo,aes(x='Total Gross',y=WeekNo))+geom_point()+ facet_wrap( ~ Title, ncol=2)
#3
ggplot(data = mojo,aes(x='Total Gross',y=WeekNo))+geom_point()+ facet_wrap( ~ Year)
?mojo
which.max(mojo$`Total Gross`)
mojo$Title[which.max(mojo$`Total Gross`)]
mojo[which.max(mojo$`Total Gross`),]
mojo$Title[which.max(mojo$`Total Gross`)]
mojo[which.max(mojo$`Total Gross`),]
mojo$Week[which.max(mojo$`Total Gross`)]
#3
ggplot(data = mojo,aes(x=WeekNo,y='Total Gross'))+geom_point()+ facet_wrap( ~ Year)
#3
ggplot(data = mojo,aes(x=WeekNo,y='Total Gross'))+geom_point()
plot(mojo$`Total Gross`)
plot(mojo$`Total Gross`,x = mojo$Week)
plot(mojo$`Total Gross`,x = mojo$WeekNo)
#3
ggplot(data = mojo,aes(x=WeekNo,y='Total Gross'))+geom_point()
#3
ggplot(data = mojo,aes(x=WeekNo,y='Total Gross'))+ geom_point(shape=1)
plot(mojo$`Total Gross`,x = mojo$WeekNo)
str(mojo)
#3
ggplot(data = mojo,aes(x=WeekNo,y=as.numeric('Total Gross')))+ geom_point(shape=1)
#3
ggplot(data = mojo,aes(x=WeekNo,y='Total Gross'))+ geom_point(shape=1)
#3
ggplot(data = mojo,aes(y=WeekNo,x='Total Gross'))+ geom_point()
#3
ggplot(data = mojo,aes(y=WeekNo,x=WeekNo))+ geom_point()
#3
ggplot(data = mojo,aes(y=WeekNo,x=`Total Gross`))+ geom_point()
#3
ggplot(data = mojo,aes(x=WeekNo,y=`Total Gross`))+ geom_point()
boxplot(mojo$WeekNo,main="Boxplot of WeekNo", ylab="WeekNo")+ facet_wrap( ~ Year)
boxplot(mojo$WeekNo,main="Boxplot of WeekNo", ylab="WeekNo")+ facet_wrap( ~ Year)
#3
ggplot(data = mojo,aes(x=WeekNo,y=`Total Gross`))+ geom_point()+ facet_wrap( ~ Year)
#3
ggplot(data = mojo,aes(x=WeekNo,y=`Total Gross`))+ geom_boxplot()+ facet_wrap( ~ Year)
#4
which(mojo$Year>=2013 $ mojo$Year>=2018)
#4
which(mojo$Year>=2013 & mojo$Year>=2018)
#4
mojo$Title[which(mojo$Year>=2013 & mojo$Year>=2018)]
#4
mojo$Title[which(mojo$Year>=2013 & mojo$Year<=2018)]
#4
length(mojo$Title[which(mojo$Year>=2013 & mojo$Year<=2018)])
which(mojo$`Total Gross`==max(mojo$`Total Gross`))
which.max(mojo$`Total Gross`)
hg<-mojo$Title[which.max(mojo$`Total Gross`)]
hg
which(mojo$Title==hg & mojo$TW==1)
length(which(mojo$Title==hg & mojo$TW==1))
#4
length(mojo$Title[which(mojo$Year>=2013 & mojo$Year<=2018)])
length(which(mojo$Title==hg & mojo$TW==1))
twoMovies<- rbind(mojo[which(mojo$Title==m1),],mojo[which(mojo$Title==m2),])
m1<-"Super Troopers 2"
m2<-"A Quiet Place"
#data for movie1
mojo[which(mojo$Title==m1),]
#data for movie2
mojo[which(mojo$Title==m2),]
twoMovies<- rbind(mojo[which(mojo$Title==m1),],mojo[which(mojo$Title==m2),])
ggplot(data = mojo,aes(x=WeekNo,y=`Total Gross`))+ geom_point()+ facet_wrap( ~ Title)
ggplot(data = twoMovies,aes(x=WeekNo,y=`Total Gross`))+ geom_point()+ facet_wrap( ~ Title)
#4
#find movies with budget
which(mojo$`Budget (in Million)`>=0)
#4
#find movies with budget
mojo$`Budget (in Million)`[which(mojo$`Budget (in Million)`>=0)]
head(mojo)
#4
#find movies with budget
is.na(mojo$`Budget (in Million)`)
#4
#find movies with budget
!is.na(mojo$`Budget (in Million)`)
#4
#find movies with budget
mojo$Title[!is.na(mojo$`Budget (in Million)`)]
#4
#find movies with budget
unique(mojo$Title[!is.na(mojo$`Budget (in Million)`)])
#4
#find movies with budget
length(unique(mojo$Title[!is.na(mojo$`Budget (in Million)`)]))
#4
#find movies with budget
moviesBudget<-unique(mojo$Title[!is.na(mojo$`Budget (in Million)`)])
which(mojo$Title in moviesBudget)
which(mojo$Title == moviesBudget)
mojo[mojo$Title %in% moviesBudget,]
length(mojo[mojo$Title %in% moviesBudget,])
dim(mojo[mojo$Title %in% moviesBudget,])
moviesBudgetData<- mojo[mojo$Title %in% moviesBudget,]
#find movies with less earning that budget in opening week
moviesBudgetData[moviesBudgetData$Week==1,]
#find movies with less earning that budget in opening week
which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000)
#find movies with less earning that budget in opening week
length(which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000))
#find movies with less earning that budget in opening week
moviesBudgetData$Title[which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000)]
#find movies with less earning that budget in opening week
flopMovies<-moviesBudgetData$Title[which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000)]
length(flopMovies)
length(unique(flopMovies))
flopMovies[duplicated(flopMovies)]
moviesBudgetData$Title[which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000) & moviesBudgetData$Title="Anomalisa"]
moviesBudgetData$Title[which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000) & moviesBudgetData$Title=="Anomalisa"]
flopMovies
moviesBudgetData$Title[which(moviesBudgetData$Title=="Anomalisa")]
moviesBudgetData[which(moviesBudgetData$Title=="Anomalisa"),]
moviesBudgetData$Title[which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000 & moviesBudgetData$Title=="Anomalisa")]
pct<-length(flopMovies)/length(moviesBudget)*100
pct
length(moviesBudget)
length(flopMovies)
80*658
pct<-length(unique(flopMovies))/length(moviesBudget)*100
pct
length(moviesBudget)
length(unique(moviesBudget))
pct_wk3<-length(unique(flopMovies_wk3))/length(moviesBudget)*100
pct_wk1<-length(unique(flopMovies_wk1))/length(moviesBudget)*100
#find movies with less earning that budget in opening week
flopMovies_wk1<-moviesBudgetData$Title[which(moviesBudgetData$Week==1 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000)]
pct_wk1<-length(unique(flopMovies_wk1))/length(moviesBudget)*100
#
flopMovies_wk3<-moviesBudgetData$Title[which(moviesBudgetData$Week==3 & moviesBudgetData$`Budget (in Million)`>moviesBudgetData$`Total Gross`/1000000)]
pct_wk3<-length(unique(flopMovies_wk3))/length(moviesBudget)*100
pct_wk1
pct_wk3
flopMovies_wk3
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo"],aes(x=WeekNo,y=`Total Gross`))+ geom_point()+ facet_wrap( ~ Title)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=WeekNo,y=`Total Gross`))+ geom_point()+ facet_wrap( ~ Title)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=WeekNo,y=`Total Gross`))+ geom_point()+ facet_wrap( ~ Week)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`))+ geom_point()
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`))+ geom_point()+ + geom_hline(yintercept=moviesBudgetData[moviesBudgetData$Title=="Turbo",]$`Budget (in Million)`, linetype="dashed", color = "red")
moviesBudgetData[moviesBudgetData$Title=="Turbo",]$`Budget (in Million)`
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`))+ geom_point()+ + geom_hline(yintercept=moviesBudgetData[moviesBudgetData$Title=="Turbo",]$`Budget (in Million)`[0], linetype="dashed", color = "red")
turboBugdetinMil=unique(moviesBudgetData[moviesBudgetData$Title=="Turbo",]$`Budget (in Million)`)*1000000
turboBugdetinMil
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`))+ geom_point()+ + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red")
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`))+ geom_point() + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red")
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`))+ geom_point() + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red", , size=2)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`))+ geom_point() + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red", , size=1)
setdiff(moviesBudget,flopMovies_wk3)
#a hit movie example
spyBugdetinMil=unique(moviesBudgetData[moviesBudgetData$Title=="Spy",]$`Budget (in Million)`)*1000000
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Spy",],aes(x=Week,y=`Total Gross`))+ geom_point() + geom_hline(yintercept=spyBugdetinMil, linetype="dashed", color = "red" , size=1)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=`Total Gross`-turboBugdetinMil))+ geom_point() + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red" , size=1)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=turboBugdetinMil-`Total Gross`))+ geom_point() + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red" , size=1)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=turboBugdetinMil-`Total Gross`))+ geom_point(show.legend = T) + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red" , size=1)+labs(caption=cap)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=turboBugdetinMil-`Total Gross`))+ geom_point(show.legend = T) + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red" , size=1)
ggplot(data = moviesBudgetData[moviesBudgetData$Title=="Turbo",],aes(x=Week,y=turboBugdetinMil-`Total Gross`))+ geom_point(show.legend = T) + geom_hline(yintercept=turboBugdetinMil, linetype="dashed", color = "red" , size=1)
+ theme(legend.position="top")
